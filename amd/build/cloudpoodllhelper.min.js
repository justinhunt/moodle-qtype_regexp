define(["jquery","core/log","qtype_regexp/cloudpoodllloader"],function(a,b,c){"use strict";return b.debug("cloudpoodll helper: initialising"),{uploadstate:!1,init:function(a){this.component=a.component,this.dom_id=a.dom_id,this.answerfieldname=a.answerfieldname,this.audiourlfieldname=a.audiourlfieldname,this.transcriber=a.transcriber,this.register_controls(),this.register_events(),this.setup_recorder()},setup_recorder:function(){var a=this,b="",d=function(c){switch(c.type){case"recording":"started"===c.action&&(b="");break;case"speech":b+="  "+c.capturedspeech,a.controls.transcript.val(b),a.controls.answer.val(b);break;case"awaitingprocessing":"posted"!=a.uploadstate&&(a.controls.audiourl.val(c.mediaurl),"amazon"==this.transcriber&&(a.controls.audiourl.val(c.mediaurl),a.controls.transcript.val(c.transcripturl),a.controls.answer.val(c.transcripturl))),a.uploadstate="posted";break;case"error":alert("PROBLEM: "+c.message)}};c.init(this.dom_id,d)},register_controls:function(){var b=CSS.escape(this.answerfieldname),c=CSS.escape(this.audiourlfieldname);this.controls={answer:a("input[name="+b+"]"),audiourl:a("input[name="+c+"]"),transcript:a("input[name="+b+"transcript]")}},register_events:function(){}}});